There is another code that exactly matches the spec provided and implemented
with json parsing is available at
https://www.dropbox.com/sh/jj6gu49hb9bwce7/AABlSSZ0UkJRLcUIDRZDdmJPa?dl=0